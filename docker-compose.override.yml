# ==============================================================================
# ElasticBot Backend - Docker Compose Override (Development)
# ==============================================================================
# Automatically loaded with docker-compose.yml for local development.
# Adds hot reload, debug mode, and exposed ports for debugging.
# ==============================================================================

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      - DEBUG=True
      - CELERY_LOG_LEVEL=debug
    volumes:
      # Mount source code for hot reload
      - .:/app:cached
      - /app/.venv  # Exclude venv from mount

  # Flower for Celery monitoring (development only)
  flower:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: elasticbot-flower
    entrypoint: []
    command: celery -A base flower --port=5555
    ports:
      - "5555:5555"
    env_file:
      - .env
    environment:
      - DEBUG=True
      - REDIS_HOST=redis
      - REDIS_PORT=6379
      - REDIS_USER=default
      - REDIS_PASSWORD=
      - REDIS_URL=
      - CELERY_BROKER_URL=redis://redis:6379/0
      - CELERY_RESULT_BACKEND=redis://redis:6379/0
    depends_on:
      - redis
      - app
    networks:
      - elasticbot-network
